<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <meta name="description" content={{ description }}>
    <meta name="keywords" content={{ keywords }}>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script src="{{'/assets/js/bundle.js' | url}}"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120208217-1"></script>
    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
        font-family: Courier New, monospace;
        letter-spacing: .1px;
      }
      
      body p {
        line-height: 19px;
      }

      .content header {
        margin: auto;
        text-align: center;
      }

      .introduction {
        margin: auto;
        max-width: 1024px;
      }

      .introduction-quote {
        font-style: italic;
        margin: auto;
        max-width: 768px;
      }

      a {
        color: black;
        border-bottom: solid black 1px;
        text-decoration: none;
      }

      .guild {
        display: inline-block;
        margin: auto;
        width: 80px;
      }

      .guild img {
        height: 90px;
        rotate: 90deg;
      }

      .guild figcaption {
        display: none;
        font-size: 7px;
        visibility: hidden;
      }

      .header-slash {
        font-size: 100px;
      }

      .wow {
        text-align: center;
        margin: 10px auto;
        display: block;
      }

      h1, h2, h3 {
        margin: 0 0 20px;
        font-family: cursive;
      }

      h1 {
        display: inline-block;
        font-size: 32px;
        letter-spacing: -1px;
      }

      h3 {
        margin-top: 30px;
      }

      .spacer {
        height: 30px;
        top: 0;
      }

      .border {
        border-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAYAAAAcaxDBAAAAAXNSR0IArs4c6QAAAnRJREFUeF7tm8FyAyEMQ8n/f3QzvXRm2XS1QsIhQb3aGHgIbNj00Vr7afljCDw65wO/X2OAMjhbC1COF/QOUIiIc4BAuXD7efdHYoCKGghQEWDfPEDfDbS6bLo8g8wwRsKh8cEzNECP2AN0RIYXbQJ0daD9CqnjpbJkO1/t1P5Re3V88C4foMcloIC/ehwJ0ABFu/rSTinwxZFEb3m2rJKyJBqwhO5eY2n8d7Z8gBJ1aoCeVRuF3tvJt73KgUod3jgj3VXGbZL/OFJJa2TLB+hFWRWgWL9RKGZEeXw8UGq2b3Cm30Orz0i2zn0Dw0OXAWpegQDdDah5vuXh5McR9xlbTsDcYYAGqJmAOdx2CnWXZctnebNgTuEC1Ew4QAOU+ESw4Hd3tH4f9ziCJqTaERAUH7XfPsuzXwQCtJMcAhKFIgIkUAScsq/wCYTkQ7tTQAY+IuYMnangKPT8n4TSa5oDKNqDaMuh9qod9W+1B2gUSgvWqkCUtKLQBRRKS6RrwN5U1P6WV6g6wQBVCUahRwKzH2jN6wVf7KU605GUZk94dvzlztDZE54dP0DNhAP024G6k5KZ1ync1KTjSEoBelwz+w8dZitMjR+FqgTBxWG5pIQGZOZBh0PjK7VXvDbRhMgGpcBmJKXqxw3EN0ARIdL+dUCry6rZWRytp71sQhNCA1LtqH/VjsYXoGRZFaAkMKTg5YBWVwFqUkIAkb38pzhoQKo9QFWCXfsADVDi+coMayScmnRG+vxr47jLVxf2aMIBigiR9gAlgSH3jweKJriV3XGGbgUMTTZAESHSHqAkMOQ+AhTF3NoeoOblD9AANRMwh3sCUQHAFEF2KngAAAAASUVORK5CYII=") 28 /  28px / 0 round;
        position: absolute;
        top: 0;
        bottom: 120px;
        left: 0;
        right: 0;
        width: 100vw;
      }

      .midi-archive-collection {
        border-top: solid black 2px;
        margin: 0 0 40px;
        max-width: calc(100vw - 80px);
      }

      .midi-archive-collection-header {
        margin-top: 20px;
        padding: 60px;
        text-align: center;
      }

      .midi-archive-collection-items {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 2px; 
        padding: 0;
      }
      .midi-archive-collection-item {
        font-size: 7px;
        list-style: none;
        padding: 0;
        position: relative;
        text-transform: uppercase;
        word-wrap: break-word;
        max-width: 100%;
      }
      .midi-archive-collection-item.playing {
        border: 1px solid red;
        font-size: 48px;
      }

      .nn-output.midi-archive-collection-item {
        font-size: 16px;
        text-transform: normal;
      }

      .midi-archive-collection-item:hover {
        cursor: grab;
      }

      .container {
        box-sizing: border-box;
        position: absolute;
        height: calc(100vh - 180px);
        overflow-y: scroll;
        width: 100%;
        word-wrap: break-word;
      }

      .content {
        margin: 10px 40px;
      }

      .midi-player {
        background-image: url({{'/assets/prairiefrontier/images/embossbkgd1.jpg' | url}});
        border: solid black 4px;
        border-top: 0;
        font-size: 12px;
        height: 120px;
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        padding-top: 10px;
        box-sizing: border-box;
      }

      .hidden {
        display: none;
      }

      {# collection-specific styling #}
      .midi-archive-collection.sankey .midi-archive-collection-header {
        background-image: url(/midi-archive/assets/sankey/images/background.gif);
        color: white
      }

      .midi-archive-collection.sankey .midi-archive-collection-header a {
        color: white
      }

      @media (min-width: 768px) {
        .content {
          margin: 10px 60px;
        }

        .guild img {
          height: 80px;
        }
      }
    </style>
  </head>
  <body>
    <div class="spacer"></div>
    <div class="border"></div>
    <div class="container">
      <div class="content">
        <header>
          <figure class="guild">
            <img src="{{'/assets/images/midi-ring.gif' | url}}" />
            <figcaption>Source: <a href="https://www.ubikmusic.com/midiring/" target=_blank>The MIDI Webring</a></figcaption>
          </figure>
          <span class="header-slash">/</span>
          <h1>
            <span style="visibility: hidden; display: none;">MIDI</span>Archive
          </h1>
        </header>
        <section class="introduction">
          <h3>{{ description }}</h3>
          {{ content | safe }}
        </section>
        <section class="midi-archive">
          <div class="midi-archive-collection neural-net">
            <h3 class="midi-archive-collection-header">Neural Net</h3>
            <p>The <a href="https://colab.research.google.com/drive/1hpzG6ygsn0Cv44ImhyOn13eHtSo_Lccg#scrollTo=2KCKQ2kVr24C" target="_blank">neural net model developed and trained for use in this project</a> is an 800k-parameter decoder-only transformer, intended to express something at once whimsical and general about the underlying archive. It is intended to serve an educationl purpose, and does not represent the state of the art in 2023, nor is it intended to be used seriously as a tool for music creation.<p>

            </p>It currently runs as an AWS Lambda Function at noon (GMT) every day to produce a piece of music around three minutes in length. Each time the model runs, it uses tokens generated from the previous pass to produce subsequent tokens, and in this way produces a single continuous piece of music that has no end, but is punctuated by a 24-hour cycle of rest, and is not presented here in its entirety. Check back tomorrow to hear new music generated by the model!</p>

            <p class="introduction-quote">"I listened to the music. It was hideous. I have never heard anything like it. It was distorted, diabolical, without sense or meaning, except, perhaps, an alien, disconcerting meaning that should never have been there. I could believe only with the greatest effort that it had once been a Bach Fugue, part of a most orderly and respected work." - Philip K. Dick, <a href="https://sickmyduck.narod.ru/pkd097-0.html"><em>The Preserving Machine</em></a></p>
            <ul class="midi-archive-collection-items">
              <li class="midi-archive-collection-item nn-output" id="neural-net-output" data-src="https://midi-archive.s3.us-east-2.amazonaws.com/neural-net/model-prediction.mid">
                <p>Click to listen to the most recent output from the model</p>
              </li>
            </ul>
          </div>

          {% for site, data in collections.midiAssets %}
            <div class="midi-archive-collection {{ site }}">
              <h3 class="midi-archive-collection-header" id="{{ site }}"><a href={{ data.homepage }} target="_blank">{{ data.name}}</a></h3>
              {% set descriptionSource = ["./src/_includes/", site, ".md"] | join %}
              {% renderFile descriptionSource %}
              <ul class="midi-archive-collection-items">
                {% for asset in data.midis %}
                  <li class="midi-archive-collection-item" id="{{ asset }}" data-src="{{ asset | url }}">
                    {{ asset.split('/midi/')[1] }}
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endfor %}
        </section>
      </div>
      <img src="{{'/assets/images/html-writers-guild.gif' | url}}" class="wow"/>
    </div>
    <div class="midi-player">
      <div class="midi-player-controls">
        <button class="play-button">Play</button>
        <button class="stop-button hidden">Pause</button>
        <button class="random-button">Random</button>
        <button class="ai-button">Play AI</button>
      </div>
      <div class="midi-player-status">
        <p class="status"></p>
        <p>
          <a class="share"></a>
        </p>
      </div>
    </div>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-120208217-1');
    </script>
  </body>
</html>