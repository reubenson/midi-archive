<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <meta name="description" content={{ description }}>
    <meta name="keywords" content={{ keywords }}>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script src="/assets/js/bundle.js"></script>
    {# <script src="/assets/js/main.js" defer></script> #}
    {# <script src="/assets/js/soundfontplayer-min.js"></script> #}
    {# <script src="http://unpkg.com/tone"></script> #}
    {# <script src="https://unpkg.com/@tonejs/midi"></script> #}
    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
      }

      .midi-archive-collection {
        display: flex;
        flex-direction: row;
        justify-content: space-between; /* Aligns items along the horizontal line */
        align-items: center; /* Aligns items along the vertical line */
        flex-wrap: wrap; /* Allows the items to wrap onto multiple lines */
        gap: 10px; 
        padding: 0;
      }
      .midi-archive-collection-item {
        list-style: none;
        padding: 10px;
        position: relative
      }
      .midi-archive-collection-item.playing {
        border: 1px solid red;
      }
      {# this element is going to prevent .midi files from being downloaded on click #}
      .midi-archive-collection-item-surface {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 1;
      }

      .container {
        box-sizing: border-box;
        position: absolute;
        height: calc(100vh - 100px);
        overflow-y: scroll;
        padding: 10px;
      }
      .midi-player {
        height: 100px;
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        border-top: dotted 2px;
        padding-top: 10px;
        box-sizing: border-box;
      }
    </style>
  </head>
  <body>
    <div class="container">
      {{ content | safe }}
      <section class="neural-net-midi">
        <p>Explore the sounds of the early web with <em>The MIDI Archive</em></p>
      </section>
      <section class="midi-archive">
        {% set totalMidiCount = 0 %}
        {% for site, data in collections.midiAssets %}
          {% set totalMidiCount = totalMidiCount + data.midis.length %}
        {% endfor %}
        <h3>There are currently {{ totalMidiCount }} MIDI files in the collection!</h3>
        <p>These files have been assembled here for your listening pleasure, as well as used to train a neural net model, which is used to produce a new piece of "music" every day.</p>
        <p>I'm still tinkering with this archive and the neural net, so check back soon for more updates!</p>
        <li class="midi-archive-collection-item">
          <div class="midi-archive-collection-item-surface"></div>
          <a href="https://midi-archive.s3.us-east-2.amazonaws.com/neural-net/model-prediction.mid">Listen to the most recent music hallucinated by the model</a>
        </li>

        {% for site, data in collections.midiAssets %}
          <section>
            <h3><a href={{ data.homepage }} target="_blank">{{ data.name}}</a></h3>
            {# <span class="dropdown">â‡©</span> #}
            <p>{{ data.description }}</p>
            <ul class="midi-archive-collection">
              {% for asset in data.midis %}
                <li class="midi-archive-collection-item">
                  <div class="midi-archive-collection-item-surface"></div>
                  <a class="midi-file" href="{{ asset }}">{{ asset.split('/midi/')[1] }}</a>
                </li>
              {% endfor %}
            </ul>
          </section>
        {% endfor %}
      </section>
    </div>
    <div class="midi-player">
      {# <marquee><p>To listen, click any .mid file above!</p></marquee> #}
      <div class="midi-player-controls">
        <button class="play-button">Play</button>
        <button class="stop-button">Stop</button>
      </div>
      <div class="midi-player-status">
        <marquee class="status"></marquee>
        {# <p class="current-time">Current Time: <span class="current-time-text">0</span></p> #}
        {# <p class="total-time">Total Time: <span class="total-time-text">0</span></p> #}
      </div>
    </div>
  </body>
</html>